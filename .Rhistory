median(stepsDay,na.rm=T)
avg<-tapply(activity$steps,activity$interval,mean,na.rm=T)
plot(avg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
head(avg)
max(avg)
rownum(max(avg))
row(max(avg))
class(avg)
avgDF<-as.data.frame(cbind(time[1:288],as.numeric(avg)),stringsasfactors=FALSE)
avgDF
str(avgDF)
avgDF<-as.matrix(cbind(time[1:288],as.numeric(avg)),stringsasfactors=FALSE)
str(avgDF)
dim(avgDF)
head(avgDF)
avgDF[,2]
as.numeric(avgDF[,2])
avgM<-as.matrix(cbind(time[1:288],as.numeric(avg)),stringsasfactors=FALSE)
avd
avgM
avgM<-as.matrix(cbind(time[1:288],avg),stringsasfactors=FALSE)
avgM
avgM[,2]<-as.numeric(avgM[,2])
avgM
as.numeric(avgM[,2])
max(avgM[,2])
max(as.numeric(avgM[,2])
)
max<-max(as.numeric(avgM[,2]))
avgM[avgM[,max],1]
avgM[max,1]
avgM[avgM[,2]==max,1]
avgM
head(avgM,300)
avgM[avgM[,2]==max,1]
compRcds<-complete.cases(activity[,1:3])
nrow(activity)-sum(compRcds)
names(activity)
head(old)
head(activity)
head(as.numeric(avgM[,1]))
head(avgM)
old<-read.csv("activity.csv",header=T)
time<-sprintf("%04d",as.numeric(as.character(old$interval)))
old$dttm<-strptime(paste(old$date,time),format="%Y-%m-%d %H%M")
```
## Step mean and distribution
steps<-tapply(old$steps,old$date,sum)
hist(steps,main="Steps Per Day",ylab="Days",xlab="Steps")
mean(steps,na.rm=T)
median(steps,na.rm=T)
avg<-tapply(old$steps,old$interval,mean,na.rm=T)
plot(avg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
avg<-as.matrix(cbind(time[1:288],avg),stringsasfactors=FALSE)
max<-max(as.numeric(avg[,2]))
avg[avg[,2]==max,1]
compRcds<-complete.cases(old[,1:3])
nrow(old)-sum(compRcds)
?data.frame
avg<-as.matrix(cbind(time[1:288],avg),stringsAsFactors=FALSE)
head(avg)
rm(avg)
avg<-tapply(old$steps,old$interval,mean,na.rm=T)
plot(avg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
avg<-as.matrix(cbind(time[1:288],avg),stringsAsFactors=FALSE)
max<-max(as.numeric(avg[,2]))
avg[avg[,2]==max,1]
?as.time
?time
chron(time=avg[avg[,2]==max,1])
library(chron)
chron(time=avg[avg[,2]==max,1])
?chron
chron(time=avg[avg[,2]==max,1],format=%H%M)
chron(time=avg[avg[,2]==max,1],format="hm"
)
chron(time=avg[avg[,2]==max,1],format="h:m")
peak<-avg[avg[,2]==max,1]
strptime(peak,"%H%M")
t<-strptime(peak,"%H%M")
str(t)
t[1]
t[[1]]
t[[2]]
t[1,1]
t[[3]]
t[[4]]
t[[5]]
t[[6]]
t[[1:10]]
t[[1:6]]
t
format(t,"%H:%M")
peak<-avg[avg[,2]==max,1]
peak
?strftime
t<-strftime(peak,"%H%M")
t<-strptime(peak,"%H%M")
format(t,"%H:%M")
comp<-complete.cases(old[,1:3])
nrow(old)-sum(comp)
?matrix
dim(old)
dim(old)[1]
new<-matrix(data=NA,nrow=dim(old)[1],ncol=dim(old)[2])
head(new)
new<-matrix(data=NA,nrow=dim(old)[1],ncol=2
)
head(new)
new<-matrix(data=NA,nrow=dim(old)[1],ncol=2,names=c("steps","dttm"))
new<-data.frame(data=NA,nrow=dim(old)[1],ncol=2,names=c("steps","dttm"))
head(new)
?data.frame
new<-data.frame(nrow=dim(old)[1],ncol=2,names=c("steps","dttm"))
head(new)
a<-data.frame(nrow=2,ncol=2)
a
new<-matrix(nrow=dim(old)[1],ncol=2,colnames=c("steps","dttm"))
new<-matrix(nrow=dim(old)[1],ncol=2,names=c("steps","dttm"))
new<-matrix(nrow=dim(old)[1],ncol=2)
head(new)
as.dataframe(new,colnames=c("steps","dttm"))
as.data.frame(new,colnames=c("steps","dttm"))
head(as.data.frame(new,colnames=c("steps","dttm")))
head(as.data.frame(new,names=c("steps","dttm")))
?table
head(old)
str(old)
rm(new)
new$a<-c(1,2,3)
new<-matrix(nrow=dim(old)[1],ncol=2)
as.numeric(avg[as.numeric(avg[,1])==old$interval,2])
head(avd)
head(avg)
avg[as.numeric(avg[,1])==old$interval,2])
avg[as.numeric(avg[,1])==old$interval,2]
class(old$interval)
class(as.integer(avg[,1]))
avg[as.integer(avg[,1])==old$interval,2]
as.integer(avg[,1])==old$interval
head(avg)
head(old)
rm(new)
new<-as.data.frame(old$steps,old$dttm)
new<-cbind(old$steps,old$dttm)
head(new)
new<-matrix(nrow=dim(old)[1],ncol=2)
new<-matrix(nrow=dim(old)[1],ncol=2)
for(i in 1:10{
if(is.na(old$steps[i])){
new[i,1]<-as.integer(avg[as.integer(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
new[i,2]<-old$dttm[i]
}
for(i in 1:10){
if(is.na(old$steps[i])){
new[i,1]<-as.integer(avg[as.integer(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
new[i,2]<-old$dttm[i]
}
head(new)
head(old)
is.na(old$steps[i])
old$dttm[1]
old$dttm[2]
new<-matrix(nrow=dim(old)[1],ncol=2)
for(i in 1:10){
print(i)
if(is.na(old$steps[i])){
print("in if")
new[i,1]<-as.integer(avg[as.integer(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
new[i,2]<-old$dttm[i]
}
new<-matrix(nrow=dim(old)[1],ncol=2)
for(i in 1:10){
print(i)
if(is.na(old$steps[i])){
print("in if")
new[i,1]<-as.integer(avg[as.integer(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
##new[i,2]<-old$dttm[i]
}
head(new)
head(old)
head(avg)
new<-matrix(nrow=dim(old)[1],ncol=2)
for(i in 1:10){
print(i)
if(is.na(old$steps[i])){
print("in if")
new[i,1]<-as.numeric(avg[as.numeric(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
##new[i,2]<-old$dttm[i]
}
head(new)
new<-matrix(nrow=dim(old)[1],ncol=2)
new[,2]<-as.date(new[,2])
for(i in 1:10){
print(i)
if(is.na(old$steps[i])){
print("in if")
new[i,1]<-as.numeric(avg[as.numeric(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
new[i,2]<-old$dttm[i]
}
new<-matrix(nrow=dim(old)[1],ncol=2)
new[,2]<-as.Date(new[,2])
for(i in 1:10){
print(i)
if(is.na(old$steps[i])){
print("in if")
new[i,1]<-as.numeric(avg[as.numeric(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
new[i,2]<-old$dttm[i]
}
head(old)
rm(new)
new<-old
for(i in 1:10){
print(i)
if(is.na(old$steps[i])){
print("in if")
new$steps[i]<-as.numeric(avg[as.numeric(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
new$dttm[i]<-old$dttm[i]
}
head(new)
head(avg)
new<-old
for(i in 1:length(old)){
if(is.na(old$steps[i])){
new$steps[i]<-as.numeric(avg[as.numeric(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
}
head(new)
head(old)
length(old)
dim(old)[1]
new<-old
for(i in 1:dim(old)[1]){
if(is.na(old$steps[i])){
new$steps[i]<-as.numeric(avg[as.numeric(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
}
head(new)
head(old)
head(old,200)
head(new,200)
head(old,200:500)
head(old,500)
head(new,300)
new<-old
for(i in 1:dim(old)[1]){
if(is.na(old$steps[i])){
new$steps[i]<-as.integer(avg[as.integer(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
}
head(new)
head(new,300)
head(old,300)
new<-old
for(i in 1:dim(old)[1]){
if(is.na(old$steps[i])){
new$steps[i]<-as.integer(avg[as.integer(avg[,1])==old$interval[i],2])
}
}
head(new,300)
head(old,300)
summary(new)
summary(old)
steps<-tapply(new$steps,new$date,sum)
hist(steps,main="Steps Per Day",ylab="Days",xlab="Steps")
names(new)
library(ggplot2)
qplot(interval,steps,data=new,facets=.~weekday)
new$weekday<-weekdays(new$date)
new$weekday<-weekdays(new$dttm)
qplot(interval,steps,data=new,facets=.~weekday)
?weekdays
head(new)
?in
if(weekdays(new$dttm)="Saturday" | weekdays(new$dttm="Sunday"){
new$weekendfl<-1
}
else{
new$weekendfl<-0
}
if(weekdays(new$dttm)="Saturday" | weekdays(new$dttm="Sunday")){
new$weekendfl<-1
}
else{
new$weekendfl<-0
}
new$day<-weekdays(new$dttm)
head(new)
new$end.fl[new$weekday=="Saturday" | new$weekday=="Sunday"]<-1
head(new)
if(1 in c(2,3,1)){"in"}
new$end.fl[new$weekday=="Monday" |
new$weekday=="Tuesday" |
new$weekday=="Wednesday" |
new$weekday=="Thursday" |
new$weekday=="Friday"]<-0
head(new)
qplot(interval,steps,data=new,facets=.~weekday)
qplot(interval,steps,data=new,facets=.~end.fl)
qplot(interval,steps,data=new,facets=end.fl~.)
library(lattice)
xyplot(steps~interval/end.fl,data=new,layout=c(1,2))
avg<-tapply(old$steps,old$interval,mean,na.rm=T)
plot(avg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
xyplot(steps~interval/end.fl,data=new,layout=c(1,2))
xyplot(steps~interval/end.fl,data=new,layout=c(2,1))
names(new)
table(new$end.fl)
dim(new)
qplot(interval,steps,data=new,facets=end.fl~.)
qplot(interval,steps,data=new,geom="line",facets=end.fl~.)
oldAvg<-tapply(old$steps,old$interval,mean,na.rm=T)
plot(oldAvg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
newAvg<-tapply(new$steps,new$interval,mean,na.rm=T)
head(newAvg)
qplot(time[1:288],newAvg,data=newAvg,facets=end.fl~.)
head(unclass(newAvg))
qplot(time[1:288],unclass(newAvg),data=newAvg,facets=end.fl~.)
head(as.numeric(newAvg))
qplot(time[1:288],as.numeric(newAvg),data=newAvg,facets=end.fl~.)
newAvg[1]
class(time[1:288])
class(as.numeric(time[1:288]))
qplot(as.numeric(time[1:288]),as.numeric(newAvg),data=newAvg,facets=end.fl~.)
par(mfrow=c(2,1))
plot(oldAvg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
newAvg<-tapply(new$steps,new$interval,mean,na.rm=T)
plot(newAvg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
par(mfrow=c(2,1))
plot(oldAvg,type="l",main="Average Daily Activity",ylab="Average steps")
newAvg<-tapply(new$steps,new$interval,mean,na.rm=T)
plot(newAvg,type="l",xlab="5-minute interval",ylab="Average steps")
lines(mean(oldAvg))
qplot(as.numeric(time[1:288]),as.numeric(newAvg),data=newAvg,facets=end.fl~.)
newAvg<-tapply(new$steps,new$interval,mean,na.rm=T)
plot(newAvg)
plot(newAvg,type="l")
qplot(newAvg,type="l")
?subset
newAvgWe<-with(subset(new,end.fl=1),tapply(new$steps,new$interval,mean,na.rm=T))
newAvgWd<-with(subset(new,end.fl=0),tapply(new$steps,new$interval,mean,na.rm=T))
qplot(newAvgWe,geom="density")
newt<-cbind(newAvgWe,NewAvgWd)
newt<-cbind(newAvgWe,newAvgWd)
class(newt)
names(newt)=c("weekend","weekday")
head(newt)
tail(newt)
avg(newAvgWe)
mean(newAvgWe)
mean(newAvgWd)
newMedian<-median(new$steps,na.rm=T);newMedian
head(new)
par(mfrow=c(2,1))
plot(oldAvg,type="l",main="Average Daily Activity",ylab="Steps before")
old<-read.csv("activity.csv",header=T)
time<-sprintf("%04d",as.numeric(as.character(old$interval)))
old$dttm<-strptime(paste(old$date,time),format="%Y-%m-%d %H%M")
oldSteps<-tapply(old$steps,old$date,sum)
hist(oldSteps,main="Steps Per Day",ylab="Days",xlab="Steps")
```
oldMean<-mean(oldSteps,na.rm=T);oldMean
oldMedian<-median(oldSteps,na.rm=T);oldMedian
oldAvg<-tapply(old$steps,old$interval,mean,na.rm=T)
plot(oldAvg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
oldAvg<-as.matrix(cbind(time[1:288],oldAvg),stringsAsFactors=FALSE)
max<-max(as.numeric(oldAvg[,2]))
peak<-oldAvg[oldAvg[,2]==max,1]
t<-strptime(peak,"%H%M")
format(t,"%H:%M")
comp<-complete.cases(old[,1:3])
nrow(old)-sum(comp)
new<-old
for(i in 1:dim(old)[1]){
if(is.na(old$steps[i])){
new$steps[i]<-as.integer(oldAvg[as.integer(oldAvg[,1])==old$interval[i],2])
}
}
```
newSteps<-tapply(new$steps,new$date,sum)
hist(newSteps,main="Steps Per Day",ylab="Days",xlab="Steps")
```
newMean<-mean(newSteps,na.rm=T);newMean
newMedian<-median(newSteps,na.rm=T);newMedian
oldMean-newMean
oldMedian-newMedian
newMean-oldMean
newMedian-oldMedian
new$day<-weekdays(new$dttm)
new$end.fl[new$day=="Saturday" | new$day=="Sunday"]<-1
new$end.fl[new$day=="Monday" | new$day=="Tuesday" | new$day=="Wednesday" | new$day=="Thursday" | new$day=="Friday"]<-0
head(new)
newAvgWe<-with(subset(new,end.fl=1),tapply(new$steps,new$interval,mean,na.rm=T))
newAvgWd<-with(subset(new,end.fl=0),tapply(new$steps,new$interval,mean,na.rm=T))
newt<-cbind(newAvgWe,newAvgWd)
head(newt)
sum(newAvgWe)
sum(newAvgWd)
new<-old
for(i in 1:dim(old)[1]){
if(is.na(old$steps[i])){
new$steps[i]<-as.integer(oldAvg[as.integer(oldAvg[,1])==old$interval[i],2])
}
}
head(new)
head(new,100)
names(new)
newSteps<-tapply(new$steps,new$date,sum)
hist(newSteps,main="Steps Per Day",ylab="Days",xlab="Steps")
newMean<-mean(newSteps,na.rm=T);newMean
newMedian<-median(newSteps,na.rm=T);newMedian
newMean-oldMean
newMedian-oldMedian
head(new)
new$day<-weekdays(new$dttm)
head(new)
tail(new)
new$end.fl[new$day=="Saturday" | new$day=="Sunday"]<-1
new$end.fl[new$day=="Monday" | new$day=="Tuesday" | new$day=="Wednesday" | new$day=="Thursday" | new$day=="Friday"]<-0
head(new)
head(new,100)
head(new,300)
head(new,600)
head(new,1200\)
head(new,1200)
head(new,1500)
head(new,1900)
plot(newAvgWe,type="l",main="Average Daily Activity",ylab="Weekend Steps")
plot(newAvgWd,type="l",xlab="5-minute interval",ylab="Weekday Steps")
head(activity)
head(old)
time
sprintf("%04d",data$interval)
sprintf("%04d",old$interval)
time<-sprintf("%04d",old$interval)
head(time)
old$interval<-as.POSIXct(strptime(old$interval,format="%H%M"))
head(old$interval)
head(old$interval,200)
head(old,200)
old<-read.csv("activity.csv",header=T)
head(old)
time<-sprintf("%04d",old$interval)
head(time)
old$interval<-strptime(old$interval,format="%H%M")
head(old$interval)
head(old$interval,200)
old<-read.csv("activity.csv",header=T)
head(old,50)
old$interval<-sprintf("%04d",old$interval)
head(old,50)
class(old$interval)
old$dttm<-strptime(paste(old$date,old$interval),format="%Y-%m-%d %H%M")
head(old,50)
oldSteps<-tapply(old$steps,old$date,sum)
hist(oldSteps,main="Distribution of Total Steps Per Day",
ylab="Number of Days",xlab="Number of Steps")
oldMean<-mean(oldSteps,na.rm=TRUE);oldMean
oldMedian<-median(oldSteps,na.rm=TRUE);oldMedian
oldAvg<-tapply(old$steps,old$interval,mean,na.rm=T)
plot(oldAvg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
head(oldAvg)
