plot(avgDaySteps,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
buckets<-plot(avgDaySteps)
str(buckets)
?plot
buckets<-plot(avgDaySteps,type="n")
str(buckets)
summary(buckets)
buckets<-hist(avgDaySteps)
str(buckets)
avgDaySteps<-tapply(activity$steps,activity$interval,mean,na.rm=T)
plot(avgDaySteps,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
?rep
time
time[1:288]
chron(time=time[1:288])
avgDaySteps<-as.data.frame(time[1:288],avgDaySteps,row.names=1:length(avgDaySteps))
head(avgDaySteps)
?as.data.frame
avgDaySteps<-as.data.frame(c(time[1:288],avgDaySteps),row.names=1:length(avgDaySteps))
avgDaySteps<-as.data.frame(c(time[1:288],avgDaySteps))
head(avgDaySteps)
avgDaySteps<-as.data.frame(cbind(time[1:288],avgDaySteps))
head(avgDaySteps)
cbind(time[1:288],avgDaySteps)
time[1:288]
avgDaySteps
avgDaySteps<-tapply(activity$steps,activity$interval,mean,na.rm=T)
head(avgDaySteps)
cbind(avgDaySteps[1:10],time[1:10])
cbind(time[1:10],avgDaySteps[1:10])
as.data.frame(cbind(time[1:10],avgDaySteps[1:10]))
avgDaySteps<-tapply(activity$steps,activity$interval,mean,na.rm=T)
plot(avgDaySteps,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
avgDaySteps<-as.data.frame(cbind(time[1:288],avgDaySteps))
head(avgDaySteps)
avgDaySteps[max(avgDaySteps),1]
avgDaySteps[max(avgDaySteps[,2]),1]
str(avgDaySteps)
avgDaySteps<-tapply(activity$steps,activity$interval,mean,na.rm=T)
str(avgDaySteps)
?as.data.frame
avgDaySteps$V1<-as.numeric(avgDaySteps$V1)
avgDaySteps[max(avgDaySteps[,2]),1]
avgDaySteps[,1]<-as.numeric(avgDaySteps[,1])
avgDaySteps<-tapply(activity$steps,activity$interval,mean,na.rm=T)
avgDaySteps<-tapply(activity$steps,activity$interval,mean,na.rm=T)
avgDayStepsDF<-as.data.frame(cbind(time[1:288],avgDaySteps))
str(avgDayStepsDF)
avgDayStepsDF$V1<-as.numeric(avgDayStepsDF$V1)
avgDayStepsDF[,2]<-as.numeric(avgDayStepsDF[,2])
avgDayStepsDF[,1]<-as.numeric(avgDayStepsDF[,1])
avgDaySteps[max(avgDaySteps[,2]),1]
avgDayStepsDF[max(avgDayStepsDF[,2]),1]
max(avgDayStepsDF)
avgDaySteps[288,]
avgDayStepsDF[288,]
max(avgDayStepsDF[,2])
max(avgDaySteps)
avgDaySteps[254,]
avgDayStepsDF[254,]
max(avgDayStepsDF[,2])
avgDayStepsDF
avgDaySteps<-tapply(activity$steps,activity$interval,mean,na.rm=T)
plot(avgDaySteps,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
avgDayStepsDF<-as.data.frame(cbind(time[1:288],avgDaySteps))
avgDayStepsDF[,2]<-as.numeric(avgDayStepsDF[,2])
avgDayStepsDF[,1]<-as.numeric(avgDayStepsDF[,1])
avgDayStepsDF[max(avgDayStepsDF[,2]),1]
avgDayStepsDF<-as.data.frame(cbind(time[1:288],avgDaySteps))
head(avgDayStepsDF)
avgDayStepsDF[,2]<-as.numeric(avgDayStepsDF[,2])
head(avgDayStepsDF)
avgDayStepsDF[,1]<-as.numeric(avgDayStepsDF[,1])
head(avgDayStepsDF)
rm(buckets)
as.numeric(avgDayStepsDF[,1])
avgDayStepsDF<-as.data.frame(cbind(time[1:288],avgDaySteps))
head(avgDayStepsDf)
avgDayStepsDF<-as.data.frame(cbind(time[1:288],avgDaySteps))
avgDayStepsDF
str(avgDaySteps)
str(avgDayStepsDF)
as.numeric(avgDayStepsDF[,1])
avgDaySteps<-tapply(activity$steps,activity$interval,mean,na.rm=T)
avgDayStepsDF<-as.data.frame(cbind(time[1:288],avgDaySteps)stringsasfactors=FALSE)
avgDayStepsDF<-as.data.frame(cbind(time[1:288],avgDaySteps),stringsasfactors=FALSE)
str(avgDayStepsDF)
class(avgDaySteps)
class(avgDaySteps[1])
avgDaySteps[1]
avgDaySteps[2]
?tapply
avgDaySteps[1,1]
dim(avgDaySteps)
as.numberic(avgDaySteps)
as.numeric(avgDaySteps)
avgDayStepsDF<-as.data.frame(cbind(time[1:288],as.numeric(avgDaySteps)),stringsasfactors=FALSE)
str(avgDayStepsDF)
head(avgDayStepsDF)
as.numeric(avgDayStepsDF[,2])
activity<-read.csv("activity.csv",header=T)
time<-sprintf("%04d",as.numeric(as.character(activity$interval)))
activity$dttm<-strptime(paste(activity$date,time),format="%Y-%m-%d %H%M")
stepsDay<-tapply(activity$steps,activity$date,sum)
rm(daySteps)
hist(stepsDay,main="Steps Per Day",ylab="Days",xlab="Steps")
mean(stepsDay,na.rm=T)
median(stepsDay,na.rm=T)
avg<-tapply(activity$steps,activity$interval,mean,na.rm=T)
plot(avg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
head(avg)
max(avg)
rownum(max(avg))
row(max(avg))
class(avg)
avgDF<-as.data.frame(cbind(time[1:288],as.numeric(avg)),stringsasfactors=FALSE)
avgDF
str(avgDF)
avgDF<-as.matrix(cbind(time[1:288],as.numeric(avg)),stringsasfactors=FALSE)
str(avgDF)
dim(avgDF)
head(avgDF)
avgDF[,2]
as.numeric(avgDF[,2])
avgM<-as.matrix(cbind(time[1:288],as.numeric(avg)),stringsasfactors=FALSE)
avd
avgM
avgM<-as.matrix(cbind(time[1:288],avg),stringsasfactors=FALSE)
avgM
avgM[,2]<-as.numeric(avgM[,2])
avgM
as.numeric(avgM[,2])
max(avgM[,2])
max(as.numeric(avgM[,2])
)
max<-max(as.numeric(avgM[,2]))
avgM[avgM[,max],1]
avgM[max,1]
avgM[avgM[,2]==max,1]
avgM
head(avgM,300)
avgM[avgM[,2]==max,1]
compRcds<-complete.cases(activity[,1:3])
nrow(activity)-sum(compRcds)
names(activity)
head(old)
head(activity)
head(as.numeric(avgM[,1]))
head(avgM)
old<-read.csv("activity.csv",header=T)
time<-sprintf("%04d",as.numeric(as.character(old$interval)))
old$dttm<-strptime(paste(old$date,time),format="%Y-%m-%d %H%M")
```
## Step mean and distribution
steps<-tapply(old$steps,old$date,sum)
hist(steps,main="Steps Per Day",ylab="Days",xlab="Steps")
mean(steps,na.rm=T)
median(steps,na.rm=T)
avg<-tapply(old$steps,old$interval,mean,na.rm=T)
plot(avg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
avg<-as.matrix(cbind(time[1:288],avg),stringsasfactors=FALSE)
max<-max(as.numeric(avg[,2]))
avg[avg[,2]==max,1]
compRcds<-complete.cases(old[,1:3])
nrow(old)-sum(compRcds)
?data.frame
avg<-as.matrix(cbind(time[1:288],avg),stringsAsFactors=FALSE)
head(avg)
rm(avg)
avg<-tapply(old$steps,old$interval,mean,na.rm=T)
plot(avg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
avg<-as.matrix(cbind(time[1:288],avg),stringsAsFactors=FALSE)
max<-max(as.numeric(avg[,2]))
avg[avg[,2]==max,1]
?as.time
?time
chron(time=avg[avg[,2]==max,1])
library(chron)
chron(time=avg[avg[,2]==max,1])
?chron
chron(time=avg[avg[,2]==max,1],format=%H%M)
chron(time=avg[avg[,2]==max,1],format="hm"
)
chron(time=avg[avg[,2]==max,1],format="h:m")
peak<-avg[avg[,2]==max,1]
strptime(peak,"%H%M")
t<-strptime(peak,"%H%M")
str(t)
t[1]
t[[1]]
t[[2]]
t[1,1]
t[[3]]
t[[4]]
t[[5]]
t[[6]]
t[[1:10]]
t[[1:6]]
t
format(t,"%H:%M")
peak<-avg[avg[,2]==max,1]
peak
?strftime
t<-strftime(peak,"%H%M")
t<-strptime(peak,"%H%M")
format(t,"%H:%M")
comp<-complete.cases(old[,1:3])
nrow(old)-sum(comp)
?matrix
dim(old)
dim(old)[1]
new<-matrix(data=NA,nrow=dim(old)[1],ncol=dim(old)[2])
head(new)
new<-matrix(data=NA,nrow=dim(old)[1],ncol=2
)
head(new)
new<-matrix(data=NA,nrow=dim(old)[1],ncol=2,names=c("steps","dttm"))
new<-data.frame(data=NA,nrow=dim(old)[1],ncol=2,names=c("steps","dttm"))
head(new)
?data.frame
new<-data.frame(nrow=dim(old)[1],ncol=2,names=c("steps","dttm"))
head(new)
a<-data.frame(nrow=2,ncol=2)
a
new<-matrix(nrow=dim(old)[1],ncol=2,colnames=c("steps","dttm"))
new<-matrix(nrow=dim(old)[1],ncol=2,names=c("steps","dttm"))
new<-matrix(nrow=dim(old)[1],ncol=2)
head(new)
as.dataframe(new,colnames=c("steps","dttm"))
as.data.frame(new,colnames=c("steps","dttm"))
head(as.data.frame(new,colnames=c("steps","dttm")))
head(as.data.frame(new,names=c("steps","dttm")))
?table
head(old)
str(old)
rm(new)
new$a<-c(1,2,3)
new<-matrix(nrow=dim(old)[1],ncol=2)
as.numeric(avg[as.numeric(avg[,1])==old$interval,2])
head(avd)
head(avg)
avg[as.numeric(avg[,1])==old$interval,2])
avg[as.numeric(avg[,1])==old$interval,2]
class(old$interval)
class(as.integer(avg[,1]))
avg[as.integer(avg[,1])==old$interval,2]
as.integer(avg[,1])==old$interval
head(avg)
head(old)
rm(new)
new<-as.data.frame(old$steps,old$dttm)
new<-cbind(old$steps,old$dttm)
head(new)
new<-matrix(nrow=dim(old)[1],ncol=2)
new<-matrix(nrow=dim(old)[1],ncol=2)
for(i in 1:10{
if(is.na(old$steps[i])){
new[i,1]<-as.integer(avg[as.integer(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
new[i,2]<-old$dttm[i]
}
for(i in 1:10){
if(is.na(old$steps[i])){
new[i,1]<-as.integer(avg[as.integer(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
new[i,2]<-old$dttm[i]
}
head(new)
head(old)
is.na(old$steps[i])
old$dttm[1]
old$dttm[2]
new<-matrix(nrow=dim(old)[1],ncol=2)
for(i in 1:10){
print(i)
if(is.na(old$steps[i])){
print("in if")
new[i,1]<-as.integer(avg[as.integer(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
new[i,2]<-old$dttm[i]
}
new<-matrix(nrow=dim(old)[1],ncol=2)
for(i in 1:10){
print(i)
if(is.na(old$steps[i])){
print("in if")
new[i,1]<-as.integer(avg[as.integer(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
##new[i,2]<-old$dttm[i]
}
head(new)
head(old)
head(avg)
new<-matrix(nrow=dim(old)[1],ncol=2)
for(i in 1:10){
print(i)
if(is.na(old$steps[i])){
print("in if")
new[i,1]<-as.numeric(avg[as.numeric(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
##new[i,2]<-old$dttm[i]
}
head(new)
new<-matrix(nrow=dim(old)[1],ncol=2)
new[,2]<-as.date(new[,2])
for(i in 1:10){
print(i)
if(is.na(old$steps[i])){
print("in if")
new[i,1]<-as.numeric(avg[as.numeric(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
new[i,2]<-old$dttm[i]
}
new<-matrix(nrow=dim(old)[1],ncol=2)
new[,2]<-as.Date(new[,2])
for(i in 1:10){
print(i)
if(is.na(old$steps[i])){
print("in if")
new[i,1]<-as.numeric(avg[as.numeric(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
new[i,2]<-old$dttm[i]
}
head(old)
rm(new)
new<-old
for(i in 1:10){
print(i)
if(is.na(old$steps[i])){
print("in if")
new$steps[i]<-as.numeric(avg[as.numeric(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
new$dttm[i]<-old$dttm[i]
}
head(new)
head(avg)
new<-old
for(i in 1:length(old)){
if(is.na(old$steps[i])){
new$steps[i]<-as.numeric(avg[as.numeric(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
}
head(new)
head(old)
length(old)
dim(old)[1]
new<-old
for(i in 1:dim(old)[1]){
if(is.na(old$steps[i])){
new$steps[i]<-as.numeric(avg[as.numeric(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
}
head(new)
head(old)
head(old,200)
head(new,200)
head(old,200:500)
head(old,500)
head(new,300)
new<-old
for(i in 1:dim(old)[1]){
if(is.na(old$steps[i])){
new$steps[i]<-as.integer(avg[as.integer(avg[,1])==old$interval[i],2])
}
else{
new$steps[i]<-old$interval[i]
}
}
head(new)
head(new,300)
head(old,300)
new<-old
for(i in 1:dim(old)[1]){
if(is.na(old$steps[i])){
new$steps[i]<-as.integer(avg[as.integer(avg[,1])==old$interval[i],2])
}
}
head(new,300)
head(old,300)
summary(new)
summary(old)
steps<-tapply(new$steps,new$date,sum)
hist(steps,main="Steps Per Day",ylab="Days",xlab="Steps")
names(new)
library(ggplot2)
qplot(interval,steps,data=new,facets=.~weekday)
new$weekday<-weekdays(new$date)
new$weekday<-weekdays(new$dttm)
qplot(interval,steps,data=new,facets=.~weekday)
?weekdays
head(new)
?in
if(weekdays(new$dttm)="Saturday" | weekdays(new$dttm="Sunday"){
new$weekendfl<-1
}
else{
new$weekendfl<-0
}
if(weekdays(new$dttm)="Saturday" | weekdays(new$dttm="Sunday")){
new$weekendfl<-1
}
else{
new$weekendfl<-0
}
new$day<-weekdays(new$dttm)
head(new)
new$end.fl[new$weekday=="Saturday" | new$weekday=="Sunday"]<-1
head(new)
if(1 in c(2,3,1)){"in"}
new$end.fl[new$weekday=="Monday" |
new$weekday=="Tuesday" |
new$weekday=="Wednesday" |
new$weekday=="Thursday" |
new$weekday=="Friday"]<-0
head(new)
qplot(interval,steps,data=new,facets=.~weekday)
qplot(interval,steps,data=new,facets=.~end.fl)
qplot(interval,steps,data=new,facets=end.fl~.)
library(lattice)
xyplot(steps~interval/end.fl,data=new,layout=c(1,2))
avg<-tapply(old$steps,old$interval,mean,na.rm=T)
plot(avg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
xyplot(steps~interval/end.fl,data=new,layout=c(1,2))
xyplot(steps~interval/end.fl,data=new,layout=c(2,1))
names(new)
table(new$end.fl)
dim(new)
qplot(interval,steps,data=new,facets=end.fl~.)
qplot(interval,steps,data=new,geom="line",facets=end.fl~.)
oldAvg<-tapply(old$steps,old$interval,mean,na.rm=T)
plot(oldAvg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
newAvg<-tapply(new$steps,new$interval,mean,na.rm=T)
head(newAvg)
qplot(time[1:288],newAvg,data=newAvg,facets=end.fl~.)
head(unclass(newAvg))
qplot(time[1:288],unclass(newAvg),data=newAvg,facets=end.fl~.)
head(as.numeric(newAvg))
qplot(time[1:288],as.numeric(newAvg),data=newAvg,facets=end.fl~.)
newAvg[1]
class(time[1:288])
class(as.numeric(time[1:288]))
qplot(as.numeric(time[1:288]),as.numeric(newAvg),data=newAvg,facets=end.fl~.)
par(mfrow=c(2,1))
plot(oldAvg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
newAvg<-tapply(new$steps,new$interval,mean,na.rm=T)
plot(newAvg,type="l",main="Average Daily Activity",
xlab="5-minute interval",ylab="Average steps")
par(mfrow=c(2,1))
plot(oldAvg,type="l",main="Average Daily Activity",ylab="Average steps")
newAvg<-tapply(new$steps,new$interval,mean,na.rm=T)
plot(newAvg,type="l",xlab="5-minute interval",ylab="Average steps")
lines(mean(oldAvg))
qplot(as.numeric(time[1:288]),as.numeric(newAvg),data=newAvg,facets=end.fl~.)
newAvg<-tapply(new$steps,new$interval,mean,na.rm=T)
plot(newAvg)
plot(newAvg,type="l")
qplot(newAvg,type="l")
?subset
newAvgWe<-with(subset(new,end.fl=1),tapply(new$steps,new$interval,mean,na.rm=T))
newAvgWd<-with(subset(new,end.fl=0),tapply(new$steps,new$interval,mean,na.rm=T))
qplot(newAvgWe,geom="density")
newt<-cbind(newAvgWe,NewAvgWd)
newt<-cbind(newAvgWe,newAvgWd)
class(newt)
names(newt)=c("weekend","weekday")
head(newt)
tail(newt)
avg(newAvgWe)
mean(newAvgWe)
mean(newAvgWd)
newMedian<-median(new$steps,na.rm=T);newMedian
head(new)
